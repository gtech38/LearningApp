<!doctype html>
<html lang="en">
	<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

	<title>Gogy</title>
	<style>
		.router-link-active {
		color: white;
		text-decoration: none;
		}
	</style>
	</head>
	<body class="bg-dark">
	<div class="bg-black container">

	<div class="jumbotron">
		<h1 class="display-4">Welcome to Gogy</h1>
		<p class="lead">
			Which deck would you like to learn?
		</p>

			<!-- Content -->
		<div id="mydeck">
			<div class="deck-list">
			<h2>Decks</h2>
			<deck-item
				v-for="deck in decks"
				v-bind:name="deck.deck_name"
			>{{deck.deck_name}}</deck-item>
			<!--Listing Decks-->
			<table class="table">
				<thead>
					<tr>
						<th scope="col">Decks</th>
						<th scope="col">Action</th>
					</tr>
				</thead>
				<tbody>
					<tr v-for="deck in decks">
						<th scope="row">${{deck.deck_name}}</th>
						  <td>
                <button class="btn btn-info" v-on:click="getDeck(deck.deck_name)">Edit</button>
                <button class="btn btn-danger" v-on:click="deleteDeck(deck.deck_name)">Delete</button>
              </td>
					</tr>
				</tbody>
			</table>
			</div>  
		</div>

		<div id="starting">
			<div class="container">
				<div class="row">			
							<table class="table">
								<thead>
									<tr>
										<th scope="col">Decks</th>
									</tr>
								</thead>
								<tbody>
									<tr v-for="deck in decks">
										<th scope="row"> {{deck.deck_name}} </th>
									</tr>
								</tbody>
							</table>
				</div>
			</div>
			<div class="loading" v-if="loading===true">Loading&#8230;</div>
		</div>
	</div>
	<!-- Vue.js -->
	<script src="https://unpkg.com/vue"></script>
	<script src="https://unpkg.com/vue-router"></script>
	<script src="https://unpkg.com/vuex"></script>

	<script>
	Vue.http.headers.common['X-CSRFToken'] = "{{ csrf_token }}";
	new Vue({
			el: ‘#starting’,
			delimiters: ['{','}'],
			data: {
			decks: [],
			loading: true,
			currentDeck: {},
			message: null,
			newDeck: { 'deck_name': null},
		},
		mounted: function() {
			this.getDecks();
		},
		methods: {
			getDecks: function() {
				this.loading = true;
				this.$http.get('/api/decks')
				.then((response) => {
					this.decks = response.data;
					this.loading = true;
				})
				.catch((err) => {
					this.loading = false;
					console.log(err);
				})
			},

			addDeck: function(){
				this.loading = true;
				this.$http.post('/api/decks/create', this.newDeck)
				.then((response) => {
					this.loading = true;
					this.getDecks();
				})
				.catch((err) => {
					this.loading = false;
					console.log(err);
				})

		},

		}
	});

	</script>

	<!-- Vue app -->
	<script>
		// store
		const mydecks = new Vuex.Decks({
			state: {
				mydecks: [
				{% for deck in decks %}
					{
						name: '{{deck.deck_name}}',
					},
				{% endfor %}
				],
			},
		})
	</script>

	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
	</body>
</html>
